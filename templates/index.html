<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Eco Traffic Vision</title>
    <meta name="description" content="AI-powered traffic analysis using CNN to classify congestion levels and provide sustainability insights for reduced emissions" />
    <meta name="author" content="Green Traffic AI" />

    <meta property="og:title" content="Eco Traffic Vision" />
    <meta property="og:description" content="Upload traffic images to get AI-driven sustainability recommendations" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/static/assets/hero-traffic-s7FLP7fA.jpg" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lovable_dev" />
    <meta name="twitter:image" content="/static/assets/hero-traffic-s7FLP7fA.jpg" />

    {# CSS injected from built assets via Vite manifest #}
    {% for css in asset_tags.css %}
    <link rel="stylesheet" href="{{ css }}">
    {% endfor %}
  </head>

  <body>
    {# Small server-rendered prediction summary for uploads (React app still mounts in #root) #}
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div id="flashes">
          {% for msg in messages %}
            <div class="flash">{{ msg }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    {% if prediction %}
    <div id="server-prediction-summary" style="padding:12px;border:1px solid #ddd;margin:12px 0;">
      <strong>Server prediction:</strong>
      <div>Label: {{ prediction }} {% if uncertain %}<span style="color:orange">(Uncertain)</span>{% endif %}</div>
      <div>Confidence: {{ confidence }}%</div>
      {% if topk %}
      <div>Top probabilities:</div>
      <ul>
        {% for item in topk %}
          <li>{{ item.label }} â€” {{ (item.probability * 100) | round(2) }}%</li>
        {% endfor %}
      </ul>
      {% endif %}
      {% if image_path %}
        <div>Uploaded image preview:</div>
        <img src="{{ url_for('static', filename=(image_path | replace('static/',''))) }}" alt="uploaded" style="max-width:240px;display:block;margin-top:8px;"/>
      {% endif %}
    </div>
    {% endif %}

    <div id="root"></div>

    {# Built entry script(s) injected from Vite manifest #}
    {% for js in asset_tags.js %}
    <script type="module" src="{{ js }}" crossorigin></script>
    {% endfor %}
  </body>
</html>
